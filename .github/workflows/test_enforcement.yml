name: Enforce Tests for PR

# on:
#   pull_request:
#     types: [ labeled, synchronize ]
on:
  workflow_call:

#Pass test if there is a label
jobs:
  enforce-test:
    runs-on: ubuntu-latest
    steps:
      - id: files
        uses: jitterbit/get-changed-files@v1
      - run: |
          for changed_file in ${{ steps.files.outputs.all }}; do
            echo "Do something with this ${changed_file}."
          done
          
      - name: "Check for tests"
        uses: brettcannon/check-for-changed-files@v1
        with:
          file-pattern: |
            tests/*.py
            tests/**/*.py
          skip-label: "tests not required"
          failure-message: "Missing a tests in $file-pattern; please add at least one or apply the $skip-label label to the pull request"
